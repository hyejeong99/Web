window.nhn=window.nhn||{},window.nhn.image=window.nhn.image||{},window.nhn.image.vscroll=function(t){var i={};function e(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,e),s.l=!0,s.exports}return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(e.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var s in t)e.d(n,s,function(i){return t[i]}.bind(null,s));return n},e.n=function(t){var i=t&&t.__esModule?function(){return t["default"]}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=0)}([function(t,i,e){var n=e(1),s=e(2),a=e(8);t.exports={Controller:n,List:s,Report:a}},function(t,i){t.exports=$Class({$init:function(t){this._htOption=t,this._assignVars(),!0===this._htOption.bPaging&&(this._assignElement(),this._attachEvent()),this._initList()},_assignVars:function(){this._oList=null,this._nWindowWidth=document.documentElement.clientWidth,this._nResizeThread=0,this._nScrollTop=0},_assignElement:function(){this._elRoot=this._htOption.elRoot,this._elNextMore=$$(this._htOption.sNextMoreClass,this._elRoot)[0],this._elNextMoreBtn=$$("a",this._elNextMore)[0]},_attachEvent:function(){$Fn(this._onClickNextMore,this).attach(this._elNextMoreBtn,"click"),$Fn(this._onScroll,this).attach(window,"scroll"),$Fn(this._onResize,this).attach(window,"resize")},_initList:function(){this._oList=new nhn.image.vscroll.List(this._htOption),this._oList.firstDraw()},_onClickNextMore:function(t){t.stopDefault(),this._oList.resetPageRequestCount(),this._oList.drawNext()},_onScroll:function(t){var i=document.documentElement.scrollHeight,e=window.scrollY?window.scrollY:document.documentElement.scrollTop,n=document.documentElement.clientHeight;Math.floor((e+n)/i*100)>("undefined"==typeof this._htOption.nReqScrollTopPer?50:this._htOption.nReqScrollTopPer)&&this._oList.drawNext()},_onResize:function(t){this._nResizeThread&&window.clearTimeout(this._nResizeThread),this._nResizeThread=setTimeout($Fn((function(){var t=document.documentElement.clientWidth;this._nWindowWidth!==t&&(this._nWindowWidth=t,this._nScrollTop=window.scrollY?window.scrollY:document.documentElement.scrollTop,this._oList.resetPageRequestCount(),this._oList.refresh(),window.scrollTo(0,this._nScrollTop))}),this).bind(),200)}})},function(t,i,e){var n=e(3);t.exports=$Class({$init:function(t){this._htOption=t,this._assign(),this._assignElement()},_assign:function(){this._bIsDrawing=!1,this._bHasPrev=!0,this._bHasNext=!0,this._aData=[],this._aHiddenData=[],this._sPageTemplate=this._htOption.sPageTemplate,this._nLastStart=this._htOption.nFirstStart,this._nPageSize=1*this._htOption.htApiOption.viewcount,this._nPageLimit=1*this._htOption.nMaxPageLimit,this._nPageRequest=0,this._fDrawCallback=null,this._nMaxLimit=4e3,this._nTotal=0},_assignElement:function(){this._elRoot=this._htOption.elRoot,this._elPhotoArea=$$(this._htOption.sPhotoWallAreaClass,this._elRoot)[0],this._elNextMore=$$(this._htOption.sNextMoreClass,this._elRoot)[0],this._elLoading=$$(this._htOption.sLoadingClass,this._elRoot)[0],this._elNoMore=$$(this._htOption.sNoMoreClass,this._elRoot)[0]},firstDraw:function(){var t=this._htOption.htFirstLodingData;this._drawStart(),this._drawCallback(!0,t.result),!0===this._htOption.bPaging&&document.documentElement.clientWidth>this._htOption.htClientSizeForAutoNext.nWidth&&document.documentElement.clientHeight>this._htOption.htClientSizeForAutoNext.nHeight&&(this._bIsDrawing=!1,this.drawNext())},refresh:function(){this._redraw()},drawNext:function(){this._bHasNext&&this._nPageRequest!==this._nPageLimit&&this._draw(!0)},resetPageRequestCount:function(){this._nPageRequest=0},_isDrawing:function(){return this._bIsDrawing},_drawStart:function(){this._bIsDrawing=!0,this._nPageRequest++},_drawEnd:function(){!0===this._htOption.bPaging&&($Element(this._elLoading).addClass("off"),this._bHasNext?this._nPageRequest===this._nPageLimit&&($Element(this._elLoading).hide(),$Element(this._elNextMore).show()):($Element(this._elLoading).hide(),$Element(this._elNextMore).hide(),this._showNoMoreNotice()));var t=this;setTimeout((function(){t._bIsDrawing=!1,null!==t._fDrawCallback&&(t._fDrawCallback(),t._fDrawCallback=null)}),500)},_showNoMoreNotice:function(){var t=this._getNextStartIndex();this._nTotal<this._nMaxLimit||t<this._nMaxLimit-1?$Element(this._elNoMore).hide():$Element(this._elNoMore).show()},_getNextStartIndex:function(){return this._nLastStart+this._nPageSize},_redraw:function(){this._isDrawing()||(window.scrollTo(0,$Element(this._elRoot).offset().top),this._aHiddenData=[],this._elPhotoArea.innerHTML="",this._drawStart(),this._addPhotoWall(this._aData,!0),this._drawEnd())},_draw:function(t){if(!this._isDrawing()){this._drawStart();var i=1;t&&(i=this._getNextStartIndex(),this._requestAjax($Fn(this._drawCallback,this).bind(t),i),this._nLastStart=i,this._nPageRequest>1&&this._nPageRequest<this._nPageLimit+1&&this._htOption.htClickLog&&this._htOption.htClickLog.onAutoScroll({start:i}))}},_drawCallback:function(t,i){this._nTotal=1*i.total;var e=i.items.item,n=this._remapData(e);this._addPhotoWall(n,t),t&&(this._aData=this._aData.concat(n),this._bHasNext=!(n.length<this._nPageSize)),this._drawEnd()},_remapData:function(t){for(var i=[],e=0,n=t.length;e<n;e++){var s=t[e].sImgSize.split("X"),a=t[e].sThumbSize.split("X"),h=this._getViewerLink(t[e]);i.push({width:s[0],height:s[1],thumb_width:a[0],thumb_height:a[1],src:t[e].sThumb,link:h.href,click:h.click,title:$S(t[e].sTitle).stripTags(),full_title:t[e].fullTitle,section_name:t[e].section_name,PCLink:t[e].PCLink,stt_data:t[e].stt_data})}return i},_addPhotoWall:function(t,i){var e=$S(this._sPageTemplate).trim().toString(),s=$(e),a=$Element(this._elPhotoArea),h=null;i?(a.append(s),h=this._aHiddenData.concat(t)):(a.prepend(s),h=[].concat(t));var o=new n(s);o.initialize(h,this._htOption.htThumbnailInfo,this._nPageSize),o.redraw(),this._aHiddenData=[].concat(o.getHiddenData())},_getViewerLink:function(t){var i=t.rank,e=t.gdid,n=t.signature,s=t.img_id,a=this._htOption.htApiOption.viewurl,h=this._htOption.sCrAreaPrefix,o=t.crArea,r=[];r.push(a),r.push("#imgId="+decodeURIComponent(s));var _=[];return _.push("r="+i),_.push("&i="+e),_.push("&g="+n),_.push("&a="+h+"*"+o),{href:r.join(""),click:_.join("")}},_requestAjax:function(t,i){var e=this._htOption.htApiOption.api,n=this._htOption.htApiOption.apiparams;n.display=this._nPageSize,n.start=i,$Ajax(e,{type:"jsonp",callbackid:"imageenlarge1234",onerror:function(){},onload:function(i){var e=i.json().result;t(e)}}).request(this._apiRequestDecode(n))},_apiRequestDecode:function(t){var i=$H();return $H(t).forEach((function(t,e,n){i.add(e,decodeURIComponent(t))})),i._table}})},function(t,i,e){var n=e(4);t.exports=n},function(t,i,e){var n=e(5),s=e(6),a=e(7);t.exports=$Class({name:"PhotoWall",_LIST_CLASS_NAME:"_photowall",_LIST_MARGIN:0,_LIST_MIN_WIDTH:300,_SCROLLBAR_WIDTH:0,$init:function(t){this._welWrapper=$Element(t),this._welList,this._wList=0,this._aDatas=null,this._bIsLastPage=!1,this._oFormatter=new s,this._timer=null,this._aHiddenData=[]},initialize:function(t,i,e){this._aDatas=t||[],this._welList=this._findListElement(),this._htThumbnailInfo=i,this._bIsLastPage=t.length<e,this._LIST_MARGIN=i.nListMargin+i.nMargin},_findListElement:function(){var t=this._welWrapper.query("."+this._LIST_CLASS_NAME);return $Element(t)},_draw:function(){if(this._aDatas){this._initListWidth();var t=this._makePhotoWallData(),i=this._oFormatter.getHtml(this._wList,t);this._welList.html(i)}},_initListWidth:function(){var t=Math.max(this._welList.width(),this._LIST_MIN_WIDTH)-this._LIST_MARGIN;this._wList=t},_makePhotoWallData:function(){for(var t=[],i=[],e=0,s=new a(this._wList),h=this._aDatas.length,o=this._htThumbnailInfo.nMaxRowLimit?this._htThumbnailInfo.nMaxRowLimit:0,r=0;r<h;){var _=new n(this._aDatas[r],this._htThumbnailInfo),l=s.addImageData(_),c=l&&r===h-1,u=o===e+1;if(s.isFull()&&u&&(c=!0),!s.isFull()&&c){for(var g=s.getRowData(),m=0,d=g.length;m<d;m++)i.push(g[m].getData());s.setRowWidthToCurrentSum()}if((s.isFull()||c)&&(s.adjustSizeOfRowDatas(),s.isFull()?t=t.concat(s.getRowData()):(o>0&&(this._bIsLastPage=!0),this._bIsLastPage&&c&&(0===this._htThumbnailInfo.nMaxRowLimit||e<this._htThumbnailInfo.nMaxRowLimit)&&(t=t.concat(s.getRowData()))),s.reset(),e++),l&&r++,e>0&&e===o)break}return this._aHiddenData=[].concat(i),t},getHiddenData:function(){return this._aHiddenData},redraw:function(){this._welList&&this._redrawAndSelectItems()},_redrawAndSelectItems:function(){this._welList.empty(),this._draw()},reset:function(){this._aDatas=null}})},function(t,i){t.exports=$Class({$init:function(t,i){this._oData=t,this._htThumbnailInfo=i,this._wOrigin=this._oData.width,this._hOrigin=this._oData.height,Math.abs((this._wOrigin/this._hOrigin).toFixed(1)-(this._oData.thumb_width/this._oData.thumb_height).toFixed(1)).toFixed(1)>.1&&(this._wOrigin=this._oData.thumb_width,this._hOrigin=this._oData.thumb_height),this._wImage=this._wOrigin,this._hImage=this._hOrigin,this._wFrame=this.getBaseFrameWidth(),this._hFrame=this.getBaseFrameHeight(),this._adjustSize()},_adjustSize:function(){this.isSmallerThanBaseSize()?this._adjustFrameToSquare():this._adjustSizeToBaseFrameHeight()},isSmallerThanBaseSize:function(){return this._wOrigin<=this.getBaseFrameWidth()&&this._hOrigin<=this.getBaseFrameHeight()},_adjustFrameToSquare:function(){this._isWidthShortenThanBaseFrameHeight()?this._wFrame=this.getBaseFrameHeight():this._wFrame=Math.floor(this._wImage)},_isWidthShortenThanBaseFrameHeight:function(){return this._wOrigin<this.getBaseFrameHeight()},_adjustSizeToBaseFrameHeight:function(){this._setWidthByHeightDifferenceRatio(),this._hImage=this._hImage*(this._wImage/this._wOrigin)},_setWidthByHeightDifferenceRatio:function(){var t=this._wOrigin*this._getBaseHeightDifferenceRatio();t=Math.min(t,this.getBaseFrameWidth()),this._wImage=t,this._wFrame=Math.floor(t),this._wFrame=Math.max(this._wFrame,70)},_getBaseHeightDifferenceRatio:function(){return this.getBaseFrameHeight()/this._hOrigin},toString:function(){return["Origin: (%d, %d)".format(this._wOrigin,this._hOrigin),"Image: (%d, %d)".format(this._wImage,this._hImage),"Frame: (%d, %d)".format(this._wFrame,this._hFrame)].join("\n")},setFrameWidth:function(t){this._wFrame=t},setFrameHeight:function(t){this._hFrame=t},setImageWidth:function(t){this._wImage=t},setImageHeight:function(t){this._hImage=t},getBaseFrameWidth:function(){return this._htThumbnailInfo.nWidth},getBaseFrameHeight:function(){return this._htThumbnailInfo.nHeight},getData:function(){return this._oData},getFrameWidth:function(){return this._wFrame},getFrameHeight:function(){return this._hFrame},getImageWidth:function(){return this._wImage},getImageHeight:function(){return this._hImage},getMargin:function(){return this._htThumbnailInfo.nMargin},getBothSidesMargin:function(){return 2*this.getMargin()}})},function(t,i){t.exports=$Class({_LIST_TEMPLATE_ID:"tmpl_photowall_list",_ITEM_TEMPLATE_ID:"tmpl_photowall_item",$init:function(){this._oListTemplate=$Template(this._LIST_TEMPLATE_ID),this._oItemTemplate=$Template(this._ITEM_TEMPLATE_ID)},getHtml:function(t,i){return this._oListTemplate.process({width:t,itemHtml:this._getItemHtml(i)})},_getItemHtml:function(t){for(var i=[],e=t.length,n=null,s=0;s<e;s++)n=t[s],i.push(this._oItemTemplate.process(this._getItemStyleData(n,s)));return i.join("")},_getItemStyleData:function(t,i){var e=t.getData(),n=t.getFrameWidth(),s=t.getFrameHeight(),a=t.getImageWidth(),h=t.getImageHeight(),o=(n-a)/2,r=(s-h)/2;return{idx:i+1,data:e,frame:{width:n,height:s,margin:t.getMargin()},image:{page:e.page,click:e.click,link:e.link,src:e.src,width:a,height:h,left:o,top:s<h?0:r},border:{width:n-2,height:s-2}}}})},function(t,i){t.exports=$Class({$init:function(t){this._wRow=t,this._wFrameSum=0,this._wMarginSum=0,this._aRowData=[],this._bIsFull=!1},addImageData:function(t){return(!this._isRowOverflowing(t)||(this._bIsFull=!0,!this._isNotPossibleToAdd(t)))&&(this._wFrameSum+=t.getFrameWidth(),this._wMarginSum+=t.getBothSidesMargin(),this._aRowData.push(t),!0)},_isRowOverflowing:function(t){return this._getOverflowingValue(t)>0},_getOverflowingValue:function(t){return this._getCurrentSum()+t.getFrameWidth()+t.getBothSidesMargin()-this._wRow},_getCurrentSum:function(){return this._wFrameSum+this._wMarginSum},_isNotPossibleToAdd:function(t){var i=t.getBaseFrameWidth()/4;return this._getOverflowingValue(t)>i},isFull:function(){return this._bIsFull},adjustSizeOfRowDatas:function(){this._getCurrentSum()>this._wRow?this._compressDatas():this._stretchDatas()},_compressDatas:function(){this._adjustEachImageData($Fn((function(t){var i=this._getFrameAreaRatio();return{wFrame:t.getFrameWidth()*i,hFrame:t.getFrameHeight(),wImage:t.getImageWidth(),hImage:t.getImageHeight()}}),this).bind())},_stretchDatas:function(){this._adjustEachImageData($Fn((function(t){var i=this._getFrameAreaRatio();return{wFrame:t.getFrameWidth()*i,hFrame:t.getFrameHeight()*i,wImage:t.getImageWidth()*i,hImage:t.getImageHeight()*i}}),this).bind())},_adjustEachImageData:function(t){var i=0;this._eachRowData((function(e){var n=t(e),s=Math.floor(n.wFrame);Math.floor(n.hFrame);(i+=n.wFrame-s)>=.99&&(s+=1,i-=1),e.setFrameWidth(s),e.setImageWidth(n.wImage),e.setImageHeight(n.hImage)}))},_getFrameAreaRatio:function(){return(this._wRow-this.getMarginSum())/this.getFrameSum()},_eachRowData:function(t){for(var i=0,e=this._aRowData.length;i<e;i++)t(this._aRowData[i])},getFrameSum:function(){return this._wFrameSum},getMarginSum:function(){return this._wMarginSum},getRowData:function(){return this._aRowData},setRowWidthToCurrentSum:function(){this._wRow=this._getCurrentSum()},reset:function(){this._wFrameSum=0,this._wMarginSum=0,this._aRowData=[],this._bIsFull=!1}})},function(t,i){t.exports=$Class({$init:function(t){this._htOption=t,this._assign(),this._attachEvent()},_assign:function(){this._elRoot=this._htOption.elRoot,this._elForm=this._htOption.elForm,this._elList=this._htOption.elList,this._elReport=$$("._report",this._elRoot)[0],this._elReportDone=$$("._done",this._elReport)[0],this._elReportButton=$$("._btn",this._elReport)[0],this._elProcess=$$("._process",this._elRoot)[0],this._elOk=$$("._ok",this._elProcess)[0],this._elCancel=$$("._cancel",this._elProcess)[0],this._elNoSelect=$$("._noselect",this._elRoot)[0],this._elClose=$$("._close",this._elNoSelect)[0],this._tpl=new $Template("%3C%3Fxml+version%3D%221.0%22+encoding%3D%22UTF-8%22%3F%3E%3CReportBatchProcess%3E%3Cheader%3E%3CinterfaceId%3EReportProcessBatchReq%3C%2FinterfaceId%3E%3CtransferReqTime%3E20100607155059%3C%2FtransferReqTime%3E%3CtotalReportCnt%3E{=totalReportCnt}%3C%2FtotalReportCnt%3E%3C%2Fheader%3E%3Cbody%3E{for num:obj in oReport}%3Citem+index%3D%22{=num+1}%22%3E%3CschRsltCatDtlCd%3E{=obj.schRsltCatDtlCd}%3C%2FschRsltCatDtlCd%3E%3CschSvcCatDtlCd%3E{=obj.schSvcCatDtlCd}%3C%2FschSvcCatDtlCd%3E%3CsvcDtlCd%3E{=obj.svcDtlCd}%3C%2FsvcDtlCd%3E%3CorgncArtclId%3E{=obj.orgncArtclId}%3C%2ForgncArtclId%3E%3CcntsUrl%3E%3C%21%5BCDATA%5B{=obj.cntsUrl}%5D%5D%3E%3C%2FcntsUrl%3E%3CorgncSvcId%3E{=obj.orgncSvcId}%3C%2ForgncSvcId%3E%3CorgncSvcNm%3E{=obj.orgncSvcNm}%3C%2ForgncSvcNm%3E%3CreportKwdNm%3E%3C%21%5BCDATA%5B{=obj.reportKwdNm}%5D%5D%3E%3C%2FreportKwdNm%3E%3CartclTitle%3E%3C%21%5BCDATA%5B{=obj.artclTitle}%5D%5D%3E%3C%2FartclTitle%3E%3CartclSumryCont%3E{=obj.artclSumryCont}%3C%2FartclSumryCont%3E%3CartclRgstrId%3E{=obj.artclRgstrId}%3C%2FartclRgstrId%3E%3CcntsLstModYmdtc%3E{=obj.cntsLstModYmdtc}%3C%2FcntsLstModYmdtc%3E%3CcntsFstRgstYmdtc%3E{=obj.cntsFstRgstYmdtc}%3C%2FcntsFstRgstYmdtc%3E%3CthmnlImgPath%3E%3C%21%5BCDATA%5B{=obj.thmnlImgPath}%5D%5D%3E%3C%2FthmnlImgPath%3E%3C%2Fitem%3E{/for}%3C%2Fbody%3E%3C%2FReportBatchProcess%3E")},_attachEvent:function(){$Fn(this._onClickReport,this).attach(this._elReportButton,"click"),$Fn(this._onClickOk,this).attach(this._elOk,"click"),$Fn(this._onClickCancel,this).attach(this._elCancel,"click"),$Fn(this._onClickClose,this).attach(this._elClose,"click")},_onClickReport:function(t){this._hideReport(),this._focus($$("input._report",this._elList)[0])},_onClickOk:function(t){var i=$$("input._report:checked",this._elList);0===i.length?(this._toggleNoSelect(!0),this._focus(this._elClose)):(this._report(i),this._showReport(),this._elReportDone.style.display="")},_onClickCancel:function(t){for(var i=$$("input._report:checked",this._elList),e=0;e<i.length;e++)i[e].checked=!1;this._showReport()},_onClickClose:function(t){$Element(this._elNoSelect).hide(),this._focus(this._elOk)},_showReport:function(){$Element(this._elProcess).hide(),$Element(this._elReportDone).hide(),this._elReport.style.display="",this._toggleNoSelect(!1),this._toggleCheckbox(!1),this._focus(this._elReportButton)},_hideReport:function(){$Element(this._elReport).hide(),$Element(this._elReportDone).hide(),this._elProcess.style.display="",this._toggleNoSelect(!1),this._toggleCheckbox(!0)},_toggleNoSelect:function(t){var i=$Element(this._elNoSelect);t?i.show():i.hide()},_toggleCheckbox:function(t){for(var i=$$("ul._photowall_list",this._elList),e=0,n=i.length;e<n;e++)t?$Element(i[e]).addClass("report_on"):$Element(i[e]).removeClass("report_on")},_focus:function(t){setTimeout($Fn((function(){t.focus()}),this).bind(),100)},_report:function(t){for(var i={totalReportCnt:0,oReport:[]},e=0,n=t.length;e<n;e++){var s=$Element(t[e]).attr("data-rid"),a=this._htOption.htResult[s];void 0!==a&&i.oReport.push(a)}if(i.totalReportCnt=i.oReport.length,i.totalReportCnt>0){var h=this._tpl.process(i);this._elForm.sendData.value=h,this._elForm.submit()}}})}]);
//# sourceMappingURL=nhn.image.vscroll.js.map